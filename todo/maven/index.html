<!doctype html>
<html lang="en-us">
  <head>
    <title> // JiangX</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.57.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Jiang Xing" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://vincent-wuhan.github.io/css/main.min.59023e5fd38d6ecb0e1dfbb295077c3c67e00e3b9eb3feaf34b5a5e6b332897a.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="maven 常用命令    命令 说明     mvn -version 查看maven的版本及配置信息   mvn archetype:create -DgroupId= DartifactId= 构建java项目   mvn archetype:create -DgroupId= DartifactId= -DarchetypeArtifactId=maven-archetype-webapp 创建web项目   mvn compile 编译项目代码   mvn package 打包项目   mvn package -Dmaven.test.skip=true 打包项目时跳过单元测试   mvn test 运行单元测试   mvn clean 清除编译产生的target文件夹内容，可以配合相应命令一起使用，如mvn clean package， mvn clean test   mvn install 打包后将其安装在本地仓库   mvn deploy 打包后将其安装到pom文件中配置的远程仓库   mvn eclipse:eclipse 将maven生成eclipse项目结构   mvn eclipse:clean 清除maven项目中eclipse的项目结构   mvn site 生成站点目录   mvn dependency:list 显示所有已经解析的所有依赖   mvn dependency:tree 以树的结构展示项目中的依赖   mvn dependency:analyze 对项目中的依赖进行分析，依赖未使用，使用单未引入   mvn tomcat:run 启动tomcat    POM文件 pom文件是maven中最重要的文件，以上命令的也需要根据pom文件进行运行。一般在构建完maven项目后需要修改pom文件添加诸如依赖关系，打包机制及一些项目的详细信息。一般的pom包含如下一些基本的信息： | 标签 | 说明| |:&mdash;&mdash;-|:&mdash;| groupId|项目或者组织的唯一标志 artifactId|项目的名称 version|项目的版本 packaging|打包机制 name|用户描述项目的名称 url|应该是只是写明开发团队的网站"/>

    <meta property="og:title" content="" />
<meta property="og:description" content="maven 常用命令    命令 说明     mvn -version 查看maven的版本及配置信息   mvn archetype:create -DgroupId= DartifactId= 构建java项目   mvn archetype:create -DgroupId= DartifactId= -DarchetypeArtifactId=maven-archetype-webapp 创建web项目   mvn compile 编译项目代码   mvn package 打包项目   mvn package -Dmaven.test.skip=true 打包项目时跳过单元测试   mvn test 运行单元测试   mvn clean 清除编译产生的target文件夹内容，可以配合相应命令一起使用，如mvn clean package， mvn clean test   mvn install 打包后将其安装在本地仓库   mvn deploy 打包后将其安装到pom文件中配置的远程仓库   mvn eclipse:eclipse 将maven生成eclipse项目结构   mvn eclipse:clean 清除maven项目中eclipse的项目结构   mvn site 生成站点目录   mvn dependency:list 显示所有已经解析的所有依赖   mvn dependency:tree 以树的结构展示项目中的依赖   mvn dependency:analyze 对项目中的依赖进行分析，依赖未使用，使用单未引入   mvn tomcat:run 启动tomcat    POM文件 pom文件是maven中最重要的文件，以上命令的也需要根据pom文件进行运行。一般在构建完maven项目后需要修改pom文件添加诸如依赖关系，打包机制及一些项目的详细信息。一般的pom包含如下一些基本的信息： | 标签 | 说明| |:&mdash;&mdash;-|:&mdash;| groupId|项目或者组织的唯一标志 artifactId|项目的名称 version|项目的版本 packaging|打包机制 name|用户描述项目的名称 url|应该是只是写明开发团队的网站" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vincent-wuhan.github.io/todo/maven/" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://vincent-wuhan.github.io"><img class="app-header-avatar" src="/avatar.jpg" alt="Jiang Xing" /></a>
      <h1>JiangX</h1>
      <p>Xing&#39;s personal website</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/vincent-wuhan/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title"></h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 1, 0001
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div></div>
    </header>
    <div class="post-content">
      

<h1 id="maven">maven</h1>

<h2 id="常用命令">常用命令</h2>

<table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">说明</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">mvn -version</td>
<td align="left">查看maven的版本及配置信息</td>
</tr>

<tr>
<td align="left">mvn archetype:create   -DgroupId=    DartifactId=</td>
<td align="left">构建java项目</td>
</tr>

<tr>
<td align="left">mvn archetype:create   -DgroupId=    DartifactId=    -DarchetypeArtifactId=maven-archetype-webapp</td>
<td align="left">创建web项目</td>
</tr>

<tr>
<td align="left">mvn compile</td>
<td align="left">编译项目代码</td>
</tr>

<tr>
<td align="left">mvn package</td>
<td align="left">打包项目</td>
</tr>

<tr>
<td align="left">mvn package -Dmaven.test.skip=true</td>
<td align="left">打包项目时跳过单元测试</td>
</tr>

<tr>
<td align="left">mvn test</td>
<td align="left">运行单元测试</td>
</tr>

<tr>
<td align="left">mvn clean</td>
<td align="left">清除编译产生的target文件夹内容，可以配合相应命令一起使用，如mvn clean package， mvn clean test</td>
</tr>

<tr>
<td align="left">mvn install</td>
<td align="left">打包后将其安装在本地仓库</td>
</tr>

<tr>
<td align="left">mvn deploy</td>
<td align="left">打包后将其安装到pom文件中配置的远程仓库</td>
</tr>

<tr>
<td align="left">mvn eclipse:eclipse</td>
<td align="left">将maven生成eclipse项目结构</td>
</tr>

<tr>
<td align="left">mvn eclipse:clean</td>
<td align="left">清除maven项目中eclipse的项目结构</td>
</tr>

<tr>
<td align="left">mvn site</td>
<td align="left">生成站点目录</td>
</tr>

<tr>
<td align="left">mvn dependency:list</td>
<td align="left">显示所有已经解析的所有依赖</td>
</tr>

<tr>
<td align="left">mvn dependency:tree</td>
<td align="left">以树的结构展示项目中的依赖</td>
</tr>

<tr>
<td align="left">mvn dependency:analyze</td>
<td align="left">对项目中的依赖进行分析，依赖未使用，使用单未引入</td>
</tr>

<tr>
<td align="left">mvn tomcat:run</td>
<td align="left">启动tomcat</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="pom文件">POM文件</h2>

<p>pom文件是maven中最重要的文件，以上命令的也需要根据pom文件进行运行。一般在构建完maven项目后需要修改pom文件添加诸如依赖关系，打包机制及一些项目的详细信息。一般的pom包含如下一些基本的信息：
| 标签  | 说明|
|:&mdash;&mdash;-|:&mdash;|
groupId|项目或者组织的唯一标志
artifactId|项目的名称
version|项目的版本
packaging|打包机制
name|用户描述项目的名称
url|应该是只是写明开发团队的网站</p>

<h2 id="maven源设置">Maven源设置</h2>

<p>在maven安装目录下找到settings.xml配置文件,在&lt;cirrors&gt;标签内添加阿里国内源</p>

<pre><code class="language-xml"> &lt;mirror&gt;
     &lt;id&gt;alimaven&lt;/id&gt;
     &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
     &lt;name&gt;aliyun maven&lt;/name&gt;
     &lt;url&gt;http://maven.aliyun.com/nexus/content/repositories/central/&lt;/url&gt;
 &lt;/mirror&gt;
</code></pre>

<h2 id="maven应用">Maven应用</h2>

<h3 id="编译选项">编译选项</h3>

<table>
<thead>
<tr>
<th align="left">Maven选项</th>
<th align="left">说明</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">-pl, &ndash;projects</td>
<td align="left">指定项目</td>
</tr>

<tr>
<td align="left">-am, &ndash;also-make</td>
<td align="left">表示同时处理选定模块所依赖的模块</td>
</tr>

<tr>
<td align="left">-amd, &ndash;also-make-dependents</td>
<td align="left">表示同时处理依赖选定模块的模块</td>
</tr>

<tr>
<td align="left">-T 1c</td>
<td align="left">表示每个cpu编译个工程</td>
</tr>

<tr>
<td align="left">-Dmaven.test.skip</td>
<td align="left">跳过测试用例开关</td>
</tr>

<tr>
<td align="left">-Dmaven.compile.fork</td>
<td align="left">多线程编译开关</td>
</tr>

<tr>
<td align="left">-N, &ndash;Non-recursive</td>
<td align="left">表示不递归子模块</td>
</tr>

<tr>
<td align="left">-rf, &ndash;resume-from</td>
<td align="left">表示从指定模块开始继续处理</td>
</tr>
</tbody>
</table>

<h3 id="maven单独构建多模块项目中的单个模块">Maven单独构建多模块项目中的单个模块</h3>

<p>说明</p>

<ul>
<li>可能存在的场景，多模块项目没有互相引用，那么此时可以单独构建单个项目，指定到子模块的pom.xml文件即可完成编译。</li>
<li>如果多模块项目各自都引用了，那么单独编译子模块的pom.xml文件会直接报错，解决方法就是编译父项目pom.xml。</li>

<li><p>如果编译父项目，那么可能会造成编译时间很慢，其中有些项目也不需要编译，解决方法如下：</p>

<pre><code class="language-txt">1 切换到工程的根目录

2 单独构建模块jsoft-web，同时会构建jsoft-web模块依赖的其他模块
mvn install -pl jsoft-web -am

3 单独构建模块jsoft-common，同时构建依赖模块jsoft-common的其他模块 
mvn install -pl jsoft-common -am -amd
</code></pre></li>
</ul>

<h3 id="docker镜像生成">Docker镜像生成</h3>

<ul>
<li>需求</li>
</ul>

<blockquote>
<ol>
<li>opendaylight feature和base分离，feature打包成kar后build为docker镜像</li>
<li>尽量不修改开源opendaylight的feature pom</li>
</ol>
</blockquote>

<ul>
<li>思路</li>
</ul>

<blockquote>
<p>针对feature的子pom编写父pom
父pom使用新增编译选项-Pkar -Pdocker
feature子pom集成父pom编译生成kar和docker镜像</p>
</blockquote>

<ul>
<li>解决方法</li>
</ul>

<blockquote>
<ol>
<li>生成包含feature镜像构建用的dockerfile的jar包</li>
<li>新增父pom，添加编译选项-Pkar和-Pdocker</li>
<li>子feature pom集成父pom</li>
</ol>
</blockquote>

<p>使用的插件列表
|插件|说明|
|:&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;|:&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-|
|karaf-maven-plugin| 构建kar包|
|docker-maven-plugin| 构建docker|
|maven-dependency-plugin| 解压kar包|
|maven-resources-plugin| 拷贝kar包|</p>

<p>父pom编译选项 -Pkar</p>

<pre><code class="language-xml">&lt;profile&gt;
    &lt;id&gt;kar&lt;/id&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.karaf.tooling&lt;/groupId&gt;
                &lt;artifactId&gt;karaf-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;4.1.7&lt;/version&gt;
                &lt;extensions&gt;true&lt;/extensions&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;features-generate-descriptor&lt;/id&gt;
                        &lt;phase&gt;verify&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;features-generate-descriptor&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;inputFile&gt;feature.xml&lt;/inputFile&gt;
                            &lt;ignoreScopeProvided&gt;true&lt;/ignoreScopeProvided&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                    &lt;execution&gt;
                        &lt;id&gt;features-create-kar&lt;/id&gt;
                        &lt;phase&gt;verify&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;kar&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/profile&gt;

</code></pre>

<p>父pom编译选项 -Pdocker</p>

<pre><code class="language-xml">&lt;profile&gt;
    &lt;id&gt;docker&lt;/id&gt;
    &lt;activation&gt;
        &lt;activeByDefault&gt;false&lt;/activeByDefault&gt;
    &lt;/activation&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.fiberhome.sdn.base&lt;/groupId&gt;
            &lt;artifactId&gt;docker-config&lt;/artifactId&gt;
            &lt;version&gt;1.0.0&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.0.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;unpack-dependencies&lt;/id&gt;
                        &lt;phase&gt;verify&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;unpack&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;artifactItems&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;com.fiberhome.sdn.base&lt;/groupId&gt;
                                    &lt;artifactId&gt;docker-config&lt;/artifactId&gt;
                                    &lt;version&gt;1.0.0&lt;/version&gt;
                                    &lt;outputDirectory&gt;${project.build.directory}/docker&lt;/outputDirectory&gt;
                                    &lt;includes&gt;docker/**&lt;/includes&gt;
                                &lt;/artifactItem&gt;
                            &lt;/artifactItems&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.0.2&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;copy-resources-feature&lt;/id&gt;
                        &lt;phase&gt;verify&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;copy-resources&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;outputDirectory&gt;${project.build.directory}/docker/docker&lt;/outputDirectory&gt;
                            &lt;resources&gt;
                                &lt;resource&gt;
                                    &lt;directory&gt;${project.build.directory}&lt;/directory&gt;
                                    &lt;includes&gt;
                                        &lt;include&gt;*.kar&lt;/include&gt;
                                    &lt;/includes&gt;
                                &lt;/resource&gt;
                            &lt;/resources&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;io.fabric8&lt;/groupId&gt;
                &lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${fabric8.version}&lt;/version&gt;

                &lt;configuration&gt;
                    &lt;verbose&gt;true&lt;/verbose&gt;
                    &lt;apiVersion&gt;1.23&lt;/apiVersion&gt;
                    &lt;registry&gt;10.190.49.56:10081&lt;/registry&gt;
                    &lt;authConfig&gt;
                        &lt;pull&gt;
                            &lt;username&gt;docker&lt;/username&gt;
                            &lt;password&gt;docker&lt;/password&gt;
                        &lt;/pull&gt;
                    &lt;/authConfig&gt;
                    &lt;images&gt;

                        &lt;!-- Build  image --&gt;
                        &lt;image&gt;
                            &lt;name&gt;fiberhome/${project.artifactId}&lt;/name&gt;
                            &lt;alias&gt;odl&lt;/alias&gt;
                            &lt;build&gt;
                                &lt;cleanup&gt;try&lt;/cleanup&gt;
                                &lt;dockerFileDir&gt;${project.build.directory}/docker/docker&lt;/dockerFileDir&gt;
                                &lt;tags&gt;
                                    &lt;tag&gt;${docker.tag}&lt;/tag&gt;
                                &lt;/tags&gt;
                            &lt;/build&gt;
                        &lt;/image&gt;
                    &lt;/images&gt;
                &lt;/configuration&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;clean-images&lt;/id&gt;
                        &lt;phase&gt;pre-clean&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;remove&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;removeAll&gt;true&lt;/removeAll&gt;
                            &lt;image&gt;fiberhome/${project.artifactId}&lt;/image&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;

                    &lt;execution&gt;
                        &lt;id&gt;generate-images&lt;/id&gt;
                        &lt;phase&gt;install&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;build&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;

                    &lt;execution&gt;
                        &lt;id&gt;push-images&lt;/id&gt;
                        &lt;phase&gt;deploy&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;push&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;image&gt;fiberhome/${project.artifactId}&lt;/image&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/profile&gt;
</code></pre>

<ul>
<li>执行</li>
</ul>

<blockquote>
<p>mvn clean install -DskipTests -Pkar -Pdocker</p>
</blockquote>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
